<div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartOffcanvasLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="cartOffcanvasLabel">Mon Panier ({{ cartService.totalItems() }})</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    @if (cartService.cartItems().length === 0) {
    <div class="text-center py-5">
      <i class="bi bi-cart-x display-1 text-muted"></i>
      <p class="mt-3">Votre panier est vide.</p>
    </div>
    } @else {
    <div class="cart-items">
      @for (item of cartService.cartItems(); track item.product.id) {
      <div class="card mb-3 border-0 shadow-sm">
        <div class="row g-0 align-items-center">
          <div class="col-md-4 p-2">
            <img [src]="item.product.thumbnail" class="img-fluid rounded-start" [alt]="item.product.title">
          </div>
          <div class="col-md-8">
            <div class="card-body">
              <h6 class="card-title text-truncate">{{ item.product.title }}</h6>
              <p class="card-text fw-bold text-primary mb-2">{{ item.product.price * 10 | number:'1.2-2' }} DH</p>

              <div class="d-flex justify-content-between align-items-center">
                <div class="input-group input-group-sm" style="width: 100px;">
                  <button class="btn btn-outline-secondary" type="button"
                    (click)="cartService.updateQuantity(item.product.id, item.quantity - 1)">-</button>
                  <input type="text" class="form-control text-center" [value]="item.quantity" readonly>
                  <button class="btn btn-outline-secondary" type="button"
                    (click)="cartService.updateQuantity(item.product.id, item.quantity + 1)">+</button>
                </div>
                <button class="btn btn-link text-danger p-0" (click)="cartService.removeFromCart(item.product.id)">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      }
    </div>

    <div class="cart-footer mt-4 pt-3 border-top">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <span class="h5 mb-0">Total</span>
        <span class="h4 mb-0 text-primary">{{ cartService.totalPrice() | number:'1.2-2' }} DH</span>
      </div>
      <button class="btn btn-primary w-100 py-2" routerLink="/checkout" data-bs-dismiss="offcanvas">Commander</button>
    </div>
    }
  </div>
</div>